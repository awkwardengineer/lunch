<!DOCTYPE html>
<!-- saved from url=(0050)http://getbootstrap.com/examples/jumbotron-narrow/ -->
<html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta name="description" content="">
    <meta name="author" content="">


    <title>Sam's Lunch System</title>

    <!-- Bootstrap core CSS -->
    <link href="http://getbootstrap.com/dist/css/bootstrap.css" rel="stylesheet">

    <!-- Custom styles for this template -->
    <link href="css/jumbotron-narrow.css" rel="stylesheet">

    <!-- HTML5 shim and Respond.js IE8 support of HTML5 elements and media queries -->
    <!--[if lt IE 9]>
      <script src="../../assets/js/html5shiv.js"></script>
      <script src="../../assets/js/respond.min.js"></script>
    <![endif]-->
  </head>

  <body>

    <div class="container">
      <div class="header">
        <ul class="nav nav-pills pull-right">
          <li><a href="index.html">Menu</a></li>
          <li class="active"><a href="admin.html">Admin</a></li>
        </ul>
        <h3 class="text-muted">Sam's Lunch System: Admin&nbsp<small>({{date}})</small></h3></h3>
      </div>
  
     <div class="row">
      <div class="col-lg-5 ">      

{% if todaysOrder.isPicked %}
        <div class= "alert alert-success">
            <h1><small>Today's restaurant is currently set as </small> {{ todaysOrder.selectPlace.id() }}</h1>
        </div>
{% else %}
        <div class= "alert alert-danger">
            <h2><small>Today's restaurant has not been set yet!</h2></small>
        </div>
{% endif %}
      
        <form action="" method="post" >
        
          
          <select name="restaurant" class="form-control">
              <option selected>Choose a restaurant</option>
{% for restaurant in restaurants %}
              <option>{{restaurant.name}}</option>
{% endfor %}
              <option>Clear restaurant (and reset orders)</option>
          </select><br>
          
{% if todaysOrder.isPicked %}
            <button type="submit" class="btn btn-lg btn-warning ">(Re)Select Restaurant</button>
{% else %}
            <button type="submit" class="btn btn-lg btn-success ">Select Restaurant</button>
{% endif %}
          
        </form>  
     </div><!-- end col6 -->        
{% if todaysOrder.isPicked %}        

      <div class="col-lg-6 col-lg-offset-1"> 
      
          <a id="orders"></a>
          
            <table class="table table-striped">
              <thead>
              <tr>
                <th>Name</th>
                <th>Ordered Item</th>
                <th>Options</th>
                <th>Price</th>
              </tr>
              </thead>
              {% if (orders == None) %}
               <td>No orders placed yet</td>
               <td></td>
               <td></td>
               <td></td>
              {% else %}
              {% for order in orders %}
              <tr>
                <td>{{order.customer}}</td>
                <td>{{order.item.get().desc}}</td>
                <td>{% if (order.option == None) %} {% else %}{{order.option}}{% endif %}</td>
                <td>{{'$%.2f' % order.item.get().price}}</td>
              </tr>
              {% endfor %}
              {% endif %}
              
            </table>     
          </div>
{% endif %}
      </div><!-- end row-->
           
    <div class="header" style="padding-top:15em">
      <h1 class="text-muted">Menu Editing Instructions</small></h1>
    </div>
    <div class="row">
    <div class="col-lg-8"> 
      <div>
      <p>The lunch menu can be edited through a google spreadsheet located <a href="https://docs.google.com/spreadsheet/ccc?key=0AhCan5cGNxiTdEFOaUJ4TkdDYzRSWkRPMkNvdFR4RXc&usp=sharing">here.</a> The spreadsheet is publicly viewable, but write access is limited. Contact Sam Feller for access.</p>

      <div class= "alert alert-danger">
          WARNING! Updating the database from the spreadsheet completely overwrites existing data on the server. Any information not included in the spreadsheet will be gone forever! Today's orders will also be cleared.
      </div>
      
      <ul>
          <li>Do NOT change the column headings.</li>
          <li>Follow the existing spreadsheet format.</li>
          <li>If the restaurant name isn't spelled exactly the same each time, it will be added as a new restaurant.</li>
          <li>The "specialrequest" column is for menu items where extra ordering information is required. The cell may be left blank.</li>
      </ul>
      
      <p>The spreadsheet is embedded below (read only) for reference</p>
      </div>
      
      <div class="header"></div>
          
      <iframe width='700' height='300' frameborder='0' src='https://docs.google.com/spreadsheet/pub?key=0AhCan5cGNxiTdEFOaUJ4TkdDYzRSWkRPMkNvdFR4RXc&single=true&gid=0&output=html&widget=true'></iframe>

      <form action="/importdata.html" method="post">
        <button id="step1" type="button" class="btn btn-lg btn-success" >Step 1: Load Spreadsheet Data</button>
        <button type="submit" id="step2" type="button" class="btn btn-lg btn-success" disabled="disabled">Step 2: Commit Spreadsheet to Database</button>
        <input name="jsonData" id="jsonData" type="hidden" value="test">
      </form>
    </div></div><!--endrow-->

    <div class="footer">
      <p>Â© Sam 2013</p>
    </div>

    </div> <!-- /container -->


    <!-- Bootstrap core JavaScript
    ================================================== -->
    <!-- Placed at the end of the document so the pages load faster -->
  

</body>

<script src="http://ajax.googleapis.com/ajax/libs/jquery/1.10.2/jquery.min.js"></script>
<script src="scripts/tabletop.js"></script>
    
<script>
    
  $(document).ready( function(){  
      var jsonData;
  
      $('#step1').click(function(){ downloadData()});
      
      function downloadData() {
        Tabletop.init( { key: '0AhCan5cGNxiTdEFOaUJ4TkdDYzRSWkRPMkNvdFR4RXc',
                         callback: function(data, tabletop) {        
                                      $('#step1').attr('class', "btn btn-lg btn-success");
                                      $('#step2').attr('class', "btn btn-lg btn-success");
                                      $('#step2').removeAttr('disabled');
                                      
                                      console.log(data);
                                      
                                      $('#jsonData').attr('value', JSON.stringify(data));
                                      jsonData = data;
                                      },
                         simpleSheet: true }
                      );
      }
  });
    
</script>

</html>